---
name: review
description: Generate weekly or monthly workflow reviews with productivity insights
allowed-tools: Read, Bash, Glob, Grep
---

# Workflow Review Command

Generate comprehensive reviews of your workflow activity.

## Usage

```
/workflow:review                # Weekly review (default)
/workflow:review weekly         # Explicit weekly review
/workflow:review monthly        # Monthly review
/workflow:review custom 14      # Custom period (days)
```

## Database Location

```bash
DB_PATH="$HOME/.claude/my-workflow/workflow.db"
```

## Data to Gather

### Sessions
```sql
SELECT
    COUNT(*) as total_sessions,
    SUM(duration_seconds) as total_duration,
    AVG(duration_seconds) as avg_duration,
    COUNT(DISTINCT project) as projects_touched,
    COUNT(DISTINCT date(started_at)) as days_active
FROM sessions
WHERE started_at >= datetime('now', '-7 days');
```

### Commitments
```sql
-- Completed this period
SELECT COUNT(*) as completed
FROM commitments
WHERE completed_at >= datetime('now', '-7 days');

-- Created this period
SELECT COUNT(*) as created
FROM commitments
WHERE created_at >= datetime('now', '-7 days');

-- Still pending (created before period)
SELECT COUNT(*) as carryover
FROM commitments
WHERE created_at < datetime('now', '-7 days')
  AND status NOT IN ('completed', 'canceled');
```

### Decisions
```sql
SELECT id, title, category, project, created_at
FROM decisions
WHERE created_at >= datetime('now', '-7 days')
ORDER BY created_at DESC;
```

### Goals Progress
```sql
SELECT
    id, title, goal_type,
    progress_percentage as current_progress,
    -- Calculate progress delta (would need history table for accuracy)
    progress_percentage as progress_delta
FROM goals
WHERE status = 'active'
ORDER BY progress_percentage DESC;
```

### Activity Timeline
```sql
SELECT
    activity_type,
    COUNT(*) as count
FROM activity_timeline
WHERE timestamp >= datetime('now', '-7 days')
GROUP BY activity_type
ORDER BY count DESC;
```

### Commits (from sessions)
```sql
SELECT
    project,
    COUNT(*) as session_count,
    SUM(json_array_length(commits)) as commit_count
FROM sessions
WHERE started_at >= datetime('now', '-7 days')
  AND commits IS NOT NULL
GROUP BY project
ORDER BY commit_count DESC;
```

## Output Format

```markdown
# Weekly Workflow Review

**Period:** Jan 20 - Jan 27, 2024
**Generated:** Jan 27, 2024 10:30 AM

## Summary

| Metric | This Week | Previous |
|--------|-----------|----------|
| Sessions | 15 | 12 |
| Time Invested | 24h 30m | 20h 15m |
| Commitments Completed | 8 | 6 |
| Decisions Made | 5 | 3 |
| Projects | 3 | 2 |

## Commitments

### Completed (8)
- [C-0012] Implemented user auth
- [C-0011] Fixed pagination bug
- [C-0010] Updated API docs
- ... (5 more)

### Created (12)
- [C-0020] Add caching layer
- [C-0019] Refactor services
- ... (10 more)

### Carryover (5)
*Items from previous periods still pending:*
- [C-0005] Review architecture proposal - 14 days old
- [C-0003] Update deployment scripts - 21 days old

## Decisions Made

| ID | Decision | Category | Project |
|----|----------|----------|---------|
| D-0015 | Use Redis for caching | technology | api-service |
| D-0014 | Adopt conventional commits | process | (global) |

## Goal Progress

- [G-0001] MVP Launch [==========-] 95% (+15%)
- [G-0002] Test Coverage [======----] 60% (+10%)
- [G-0003] Documentation [===-------] 30% (+5%)

## Project Breakdown

### claude-code-plugins
- Sessions: 8
- Duration: 14h 20m
- Commits: 23

### api-service
- Sessions: 5
- Duration: 8h 10m
- Commits: 15

### website
- Sessions: 2
- Duration: 2h
- Commits: 5

## Productivity Patterns

### Most Productive Times
- Morning (9-12): 45% of sessions
- Afternoon (13-17): 35% of sessions
- Evening (18+): 20% of sessions

### Session Length Distribution
- Short (<30m): 5 sessions
- Medium (30m-2h): 7 sessions
- Long (>2h): 3 sessions

## Recommendations

Based on this week's activity:

1. **Address Carryover** - 5 items have been pending for 2+ weeks
2. **Goal Focus** - Documentation goal is lagging, consider prioritizing
3. **Time Boxing** - Average session is 1h 38m, consider shorter focused sessions

---
*Review generated by my-workflow plugin*
```

## Vault Sync

If vault integration is enabled, save the review:

```bash
VAULT_PATH=$(jq -r '.vaultPath' ~/.claude/obsidian-vault.json)
WORKFLOW_FOLDER="$VAULT_PATH/workflow/reviews"
mkdir -p "$WORKFLOW_FOLDER"

FILENAME="review-$(date +%Y-%m-%d).md"
# Write review content to file
```
